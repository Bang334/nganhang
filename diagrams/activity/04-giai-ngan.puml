@startuml Activity - Giải ngân

title Phần 4: Giải ngân khoản vay

|Khách hàng|
start
:Đến chi nhánh;
:Ký hợp đồng vay;

if (Có tài sản TC?) then (yes)
  :Ký giấy thế chấp;
  :Nộp sổ đỏ gốc;
  
  |Cán bộ tín dụng|
  :Đăng ký TC tại\ncơ quan nhà nước;
  note right
    3-5 ngày làm việc
  end note
  :Chờ hoàn tất thủ tục;
endif

|Cán bộ tín dụng|
:Kiểm tra hợp đồng;

if (Đã đủ điều kiện?) then (yes)
  :Thực hiện giải ngân;
  
  |Hệ thống|
  :Tính phí giải ngân;
  :START TRANSACTION;
  :UPDATE Loans\nstatus = ACTIVE;
  :UPDATE Accounts\nbalance += amount - fee;
  :INSERT Transaction;
  :Tạo lịch trả nợ;
  :COMMIT;
  
  |Khách hàng|
  :Nhận tiền vào TK;
  :Xem lịch trả nợ;
  stop
else (no)
  :Chờ bổ sung;
  stop
endif

@enduml

