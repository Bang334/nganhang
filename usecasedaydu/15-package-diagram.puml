@startuml Package Diagram
!theme plain

title Sơ đồ Gói - Cấu trúc Package Hệ thống

package "com.bank.system" {
    
    package "presentation" <<Web Layer>> {
        package "controllers" {
            class AccountController
            class TransactionController
            class SavingsController
            class LoanController
            class CustomerController
            class AdminController
        }
        
        package "dto" {
            class AccountDTO
            class TransactionDTO
            class LoanDTO
            class CustomerDTO
        }
        
        package "validators" {
            class AccountValidator
            class TransactionValidator
            class LoanValidator
        }
    }
    
    package "application" <<Application Layer>> {
        package "services" {
            package "account" {
                class AccountService
                class AccountTypeService
                class CardService
            }
            
            package "transaction" {
                class TransactionService
                class TransferService
                class DepositService
                class WithdrawService
            }
            
            package "savings" {
                class SavingsService
                class SavingsMaturityService
                class InterestCalculatorService
            }
            
            package "loan" {
                class LoanService
                class LoanApprovalService
                class LoanPaymentService
                class LoanMaturityService
            }
            
            package "customer" {
                class CustomerService
                class CreditScoreService
                class CollateralService
            }
            
            package "admin" {
                class ReportService
                class ConfigurationService
                class BranchService
                class EmployeeService
            }
        }
        
        package "interfaces" {
            interface IAccountService
            interface ITransactionService
            interface ILoanService
            interface ISavingsService
        }
    }
    
    package "domain" <<Domain Layer>> {
        package "models" {
            package "account" {
                class Account
                class AccountType
                class Card
            }
            
            package "transaction" {
                class Transaction
                class TransactionType
            }
            
            package "savings" {
                class SavingsDeposit
                class SavingsInterestRate
                class SavingsTransaction
            }
            
            package "loan" {
                class Loan
                class LoanType
                class LoanInterestRate
                class LoanPayment
                class LoanPaymentSchedule
            }
            
            package "customer" {
                class Customer
                class CreditScore
                class Collateral
                class CollateralType
            }
            
            package "organization" {
                class Branch
                class Employee
                class Role
            }
        }
        
        package "enums" {
            enum AccountStatus
            enum TransactionStatus
            enum LoanStatus
            enum CardType
        }
        
        package "valueobjects" {
            class Money
            class AccountNumber
            class LoanNumber
            class InterestRate
        }
    }
    
    package "infrastructure" <<Infrastructure Layer>> {
        package "persistence" {
            package "repositories" {
                class AccountRepository
                class TransactionRepository
                class SavingsRepository
                class LoanRepository
                class CustomerRepository
            }
            
            package "mappers" {
                class AccountMapper
                class LoanMapper
                class CustomerMapper
            }
            
            class DatabaseContext
        }
        
        package "external" {
            package "payment" {
                class PaymentGatewayAdapter
                interface IPaymentGateway
            }
            
            package "notification" {
                class SMSService
                class EmailService
                class NotificationService
            }
            
            package "credit" {
                class CICAdapter
                interface ICreditBureau
            }
            
            package "storage" {
                class FileStorageService
                class DocumentService
            }
        }
        
        package "security" {
            class AuthenticationService
            class AuthorizationService
            class OTPService
            class EncryptionService
        }
        
        package "caching" {
            class RedisCache
            class CacheService
        }
        
        package "scheduler" {
            class JobScheduler
            class MaturityJobHandler
            class PaymentJobHandler
            class ReportJobHandler
        }
    }
    
    package "shared" <<Shared Kernel>> {
        package "exceptions" {
            class BusinessException
            class ValidationException
            class NotFoundException
        }
        
        package "utils" {
            class DateTimeHelper
            class FinancialCalculator
            class StringHelper
            class ValidationHelper
        }
        
        package "constants" {
            class ErrorCodes
            class BusinessRules
            class Configuration
        }
        
        package "logging" {
            class Logger
            class AuditLogger
        }
    }
}

' Dependencies
presentation ..> application : uses
application ..> domain : uses
application ..> infrastructure : uses
infrastructure ..> domain : uses
infrastructure ..> shared : uses
application ..> shared : uses
presentation ..> shared : uses

' Notes
note right of presentation
  **Presentation Layer**
  - REST API Controllers
  - Request/Response DTOs
  - Input Validation
  - Error Handling
end note

note right of application
  **Application Layer**
  - Business Logic
  - Use Case Implementation
  - Service Orchestration
  - Transaction Management
end note

note right of domain
  **Domain Layer**
  - Business Entities
  - Domain Logic
  - Value Objects
  - Domain Events
end note

note right of infrastructure
  **Infrastructure Layer**
  - Database Access
  - External Services
  - File Storage
  - Caching
  - Security
end note

note right of shared
  **Shared Kernel**
  - Common Utilities
  - Exceptions
  - Constants
  - Helpers
end note

@enduml











